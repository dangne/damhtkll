/*
 * mlp.h
 *
 *  Created on: Jun 16, 2019
 *      Author: tienanh
 */

#ifndef SRC_MLP_H_
#define SRC_MLP_H_

#include "matrix.h"

// Number of units in each layer
#define UNIT_LAYER_INPUT	784
#define UNIT_LAYER_1		64
#define UNIT_LAYER_OUTPUT	10

// Define macros
#define RELU(a) {\
    for (int i = 0 ; i < LEN(a) ; ++i)\
        for (int j = 0 ; j < LEN(a[0]) ; ++j)\
            a[i][j] = (a[i][j] > 0 ? a[i][j] : 0);\
}\

#define SOFTMAX(a) {\
    double sum = 0;\
	for(int i = 0 ; i < LEN(a) ; i++){\
    	for (int j = 0 ; j < LEN(a[0]) ; j++){\
            sum += (a[i][j] = exp(a[i][j]));\
	for(int i = 0 ; i < LEN(a) ; i++){\
    	for (int j = 0 ; j < LEN(a[0]) ; j++){\
    		a[i][j] /= sum;\
}\

#endif /* SRC_MLP_H_ */
